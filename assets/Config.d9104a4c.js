import{r as O,b as c,j as t,k as u,s as E,R as J,c as K,l as Q,n as $,o as R,q as X,i as D,d as M,t as Y,g as W,v as Z,w as ee,x as C,e as te,y as ne,z as oe,A as re,D as ae,u as le,C as se,E as x,B as y,G as ie,H as ce}from"./index.2260f7b0.js";import{r as de}from"./logs.54793aab.js";import{S as b}from"./Select.7e8de91b.js";import{R as pe}from"./rotate-cw.cedef2d0.js";function ue(e,l){if(e==null)return{};var a=he(e,l),r,n;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],!(l.indexOf(r)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,r)||(a[r]=e[r]))}return a}function he(e,l){if(e==null)return{};var a={},r=Object.keys(e),n,o;for(o=0;o<r.length;o++)n=r[o],!(l.indexOf(n)>=0)&&(a[n]=e[n]);return a}var S=O.exports.forwardRef(function(e,l){var a=e.color,r=a===void 0?"currentColor":a,n=e.size,o=n===void 0?24:n,d=ue(e,["color","size"]);return c("svg",{ref:l,xmlns:"http://www.w3.org/2000/svg",width:o,height:o,viewBox:"0 0 24 24",fill:"none",stroke:r,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...d,children:[t("polyline",{points:"8 17 12 21 16 17"}),t("line",{x1:"12",y1:"12",x2:"12",y2:"21"}),t("path",{d:"M20.88 18.09A5 5 0 0 0 18 9h-1.26A8 8 0 1 0 3 16.29"})]})});S.propTypes={color:u.exports.string,size:u.exports.oneOfType([u.exports.string,u.exports.number])};S.displayName="DownloadCloud";const fe=S;function ge(e,l){if(e==null)return{};var a=ve(e,l),r,n;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],!(l.indexOf(r)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,r)||(a[r]=e[r]))}return a}function ve(e,l){if(e==null)return{};var a={},r=Object.keys(e),n,o;for(o=0;o<r.length;o++)n=r[o],!(l.indexOf(n)>=0)&&(a[n]=e[n]);return a}var N=O.exports.forwardRef(function(e,l){var a=e.color,r=a===void 0?"currentColor":a,n=e.size,o=n===void 0?24:n,d=ge(e,["color","size"]);return c("svg",{ref:l,xmlns:"http://www.w3.org/2000/svg",width:o,height:o,viewBox:"0 0 24 24",fill:"none",stroke:r,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...d,children:[t("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),t("polyline",{points:"16 17 21 12 16 7"}),t("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})});N.propTypes={color:u.exports.string,size:u.exports.oneOfType([u.exports.string,u.exports.number])};N.displayName="LogOut";const me=N;function ye(e,l){if(e==null)return{};var a=be(e,l),r,n;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],!(l.indexOf(r)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,r)||(a[r]=e[r]))}return a}function be(e,l){if(e==null)return{};var a={},r=Object.keys(e),n,o;for(o=0;o<r.length;o++)n=r[o],!(l.indexOf(n)>=0)&&(a[n]=e[n]);return a}var P=O.exports.forwardRef(function(e,l){var a=e.color,r=a===void 0?"currentColor":a,n=e.size,o=n===void 0?24:n,d=ye(e,["color","size"]);return c("svg",{ref:l,xmlns:"http://www.w3.org/2000/svg",width:o,height:o,viewBox:"0 0 24 24",fill:"none",stroke:r,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...d,children:[t("polyline",{points:"3 6 5 6 21 6"}),t("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}),t("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),t("line",{x1:"14",y1:"11",x2:"14",y2:"17"})]})});P.propTypes={color:u.exports.string,size:u.exports.oneOfType([u.exports.string,u.exports.number])};P.displayName="Trash2";const ke=P,{useState:we,useRef:Ce,useEffect:xe,useCallback:_e}=J;function Oe(e){return t("input",{className:E.input,...e})}function Se({value:e,...l}){const[a,r]=we(e),n=Ce(e);xe(()=>{n.current!==e&&r(e),n.current=e},[e]);const o=_e(d=>r(d.target.value),[r]);return t("input",{className:E.input,value:a,onChange:o,...l})}const Ne="_root_1tdl3_1",Pe="_section_1tdl3_2",je="_wrapSwitch_1tdl3_26",Ie="_sep_1tdl3_32",ze="_label_1tdl3_45",i={root:Ne,section:Pe,wrapSwitch:je,sep:Ie,label:ze},Le="_fieldset_1ghjp_1",Te="_input_1ghjp_9",$e="_cnt_1ghjp_9",_={fieldset:Le,input:Te,cnt:$e};function Re({OptionComponent:e,optionPropsList:l,selectedIndex:a,onChange:r}){const n=K("visually-hidden",_.input),o=d=>{r(d.target.value)};return t("fieldset",{className:_.fieldset,children:l.map((d,m)=>c("label",{children:[t("input",{type:"radio",checked:a===m,name:"selection",value:m,"aria-labelledby":"traffic chart type "+m,onChange:o,className:n}),t("div",{className:_.cnt,children:t(e,{...d})})]},m))})}const{useMemo:Ee}=D,De={plugins:{legend:{display:!1}},scales:{x:{display:!1,type:"category"},y:{display:!1,type:"linear"}}},A=[23e3,35e3,46e3,33e3,9e4,68e3,23e3,45e3],Me=[184e3,183e3,196e3,182e3,19e4,186e3,182e3,189e3],We=A;function Ae({id:e}){const l=Q.read(),a=Ee(()=>({labels:We,datasets:[{...$,...R[e].up,data:A},{...$,...R[e].down,data:Me}]}),[e]),r="chart-"+e;return X(l.Chart,r,a,null,De),t("div",{style:{width:100,padding:5},children:t("canvas",{id:r})})}const{useEffect:F,useState:Fe,useCallback:g,useRef:Ve}=D,Be=[{id:0},{id:1},{id:2},{id:3}],Ue=[["debug","Debug"],["info","Info"],["warning","Warning"],["error","Error"],["silent","Silent"]],Ge=[{key:"port",label:"HTTP Proxy Port"},{key:"socks-port",label:"SOCKS5 Proxy Port"},{key:"mixed-port",label:"Mixed Port"},{key:"redir-port",label:"Redir Port"},{key:"mitm-port",label:"MITM Port"}],He=[["zh","\u4E2D\u6587"],["en","English"]],qe=[["direct","Direct"],["rule","Rule"],["script","Script"],["global","Global"]],Je=[["gVisor","gVisor"],["System","System"]],Ke=e=>({configs:Y(e),apiConfig:W(e)}),Qe=e=>({selectedChartStyleIndex:ie(e),latencyTestUrl:ce(e),apiConfig:W(e)}),Xe=M(Qe)(Ze),rt=M(Ke)(Ye);function Ye({dispatch:e,configs:l,apiConfig:a}){return F(()=>{e(Z(a))},[e,a]),t(Xe,{configs:l})}function Ze({dispatch:e,configs:l,selectedChartStyleIndex:a,latencyTestUrl:r,apiConfig:n}){const[o,d]=Fe(l),m=Ve(l);F(()=>{m.current!==l&&d(l),m.current=l},[l]);const V=g(()=>{e(ee("apiConfig"))},[e]),k=g((s,p)=>{d({...o,[s]:p})},[o]),j=g((s,p)=>{const f={...o.tun,[s]:p};d({...o,tun:{...f}})},[o]),v=g(({name:s,value:p})=>{switch(s){case"mode":case"log-level":case"allow-lan":case"sniffing":k(s,p),e(C(n,{[s]:p})),s==="log-level"&&de({...n,logLevel:p});break;case"mitm-port":case"redir-port":case"socks-port":case"mixed-port":case"port":if(p!==""){const f=parseInt(p,10);if(f<0||f>65535)return}k(s,p);break;case"enable":case"stack":j(s,p),e(C(n,{tun:{[s]:p}})).then(()=>{te(n)});break;default:return}},[n,e,k,j]),B=g(s=>v(s.target),[v]),{selectChartStyleIndex:U,updateAppConfig:I}=ne(),z=g(s=>{const p=s.target,{name:f,value:T}=p;switch(f){case"port":case"socks-port":case"mixed-port":case"redir-port":case"mitm-port":{const w=parseInt(T,10);if(w<0||w>65535)return;e(C(n,{[f]:w}));break}case"latencyTestUrl":{I(f,T);break}default:throw new Error(`unknown input name ${f}`)}},[n,e,I]),G=g(()=>{e(oe(n))},[n,e]),H=g(()=>{e(re(n))},[n,e]),q=g(()=>{e(ae(n))},[n,e]),{t:h,i18n:L}=le();return c("div",{children:[t(se,{title:h("Config")}),c("div",{className:i.root,children:[Ge.map(s=>o[s.key]!==void 0?c("div",{children:[t("div",{className:i.label,children:s.label}),t(Oe,{name:s.key,value:o[s.key],onChange:B,onBlur:z})]},s.key):null),c("div",{children:[t("div",{className:i.label,children:"Mode"}),t(b,{options:qe,selected:o.mode,onChange:s=>v({name:"mode",value:s.target.value})})]}),c("div",{children:[t("div",{className:i.label,children:"Log Level"}),t(b,{options:Ue,selected:o["log-level"],onChange:s=>v({name:"log-level",value:s.target.value})})]}),c("div",{children:[t("div",{className:i.label,children:h("allow_lan")}),t("div",{className:i.wrapSwitch,children:t(x,{name:"allow-lan",checked:o["allow-lan"],onChange:s=>v({name:"allow-lan",value:s})})})]}),c("div",{children:[t("div",{className:i.label,children:h("tls_sniffing")}),t("div",{className:i.wrapSwitch,children:t(x,{name:"sniffing",checked:o.sniffing,onChange:s=>v({name:"sniffing",value:s})})})]})]}),t("div",{className:i.sep,children:t("div",{})}),c("div",{className:i.section,children:[c("div",{children:[t("div",{className:i.label,children:h("enable_tun_device")}),t("div",{className:i.wrapSwitch,children:t(x,{checked:o.tun.enable,onChange:s=>v({name:"enable",value:s})})})]}),c("div",{children:[t("div",{className:i.label,children:"TUN IP Stack"}),t(b,{options:Je,selected:o.tun.stack,onChange:s=>v({name:"stack",value:s.target.value})})]})]}),t("div",{className:i.sep,children:t("div",{})}),c("div",{className:i.section,children:[c("div",{children:[t("div",{className:i.label,children:"Reload"}),t(y,{start:t(pe,{size:16}),label:h("reload_config_file"),onClick:G})]}),c("div",{children:[t("div",{className:i.label,children:"GEO Databases"}),t(y,{start:t(fe,{size:16}),label:h("update_geo_databases_file"),onClick:H})]}),c("div",{children:[t("div",{className:i.label,children:"FakeIP"}),t(y,{start:t(ke,{size:16}),label:h("flush_fake_ip_pool"),onClick:q})]})]}),t("div",{className:i.sep,children:t("div",{})}),c("div",{className:i.section,children:[c("div",{children:[t("div",{className:i.label,children:h("latency_test_url")}),t(Se,{name:"latencyTestUrl",type:"text",value:r,onBlur:z})]}),c("div",{children:[t("div",{className:i.label,children:h("lang")}),t("div",{children:t(b,{options:He,selected:L.language,onChange:s=>L.changeLanguage(s.target.value)})})]}),c("div",{children:[t("div",{className:i.label,children:h("chart_style")}),t(Re,{OptionComponent:Ae,optionPropsList:Be,selectedIndex:a,onChange:U})]}),c("div",{children:[t("div",{className:i.label,children:"Action"}),t(y,{start:t(me,{size:16}),label:"Switch backend",onClick:V})]})]})]})}export{rt as default};
